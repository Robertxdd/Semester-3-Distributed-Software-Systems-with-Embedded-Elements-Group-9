<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Smart Desk Supervisor - Sign in</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="login-wrap">
    <!-- Left: Hero & value proposition -->
    <aside class="login-hero">
      <header class="brand">
        <div class="logo" aria-hidden="true">S</div>
        <div>
          <div>Smart Desk Supervisor</div>
          <div class="helper" style="margin-top: 0.15rem;">Distributed desks, healthier teams</div>
        </div>
      </header>

      <section class="hero-copy">
        <p class="eyebrow">Distributed desk supervision</p>
        <h1>Healthier habits and orchestration-ready desk control.</h1>
        <p>
          Live desk telemetry, sit/stand balance, and maintenance insights in one
          interface. Designed for labs and offices that want a calm, premium feel.
        </p>

        <div class="hero-grid">
          <div class="hero-chip">Instant posture recommendations based on your last movements</div>
          <div class="hero-chip">Role-aware dashboards (admin, manager, individual)</div>
          <div class="hero-chip">Energy-aware defaults with idle savings baked in</div>
        </div>

        <div class="hero-illustration">
          <p class="hero-kpi">
            <strong>+41%</strong> balanced sit/stand time
          </p>
          <p class="hero-kpi">
            <strong>? 28%</strong> maintenance incidents
          </p>
          <p class="hero-kpi">
            <strong>Idle power saving</strong> enabled by default
          </p>
          <p class="hero-kpi">
            <strong>Manager view</strong> ready for real API data
          </p>
        </div>
      </section>
    </aside>

    <!-- Right: Login form -->
    <main class="login-panel">
      <section class="card login-card">
        <h2>Sign in to your workspace</h2>
        <p class="login-meta">
          Pick your role to access desk control, health dashboards, or manager reports.
        </p>

        <form class="form" method="post" action="#">
          <div class="field">
            <label for="email">Work email</label>
            <input id="email" name="email" type="email" class="input" placeholder="you@company.com" required>
          </div>

          <div class="field">
            <label for="password">Password</label>
            <input id="password" name="password" type="password" class="input" placeholder="••••••••" required>
          </div>

          <div class="field">
            <label for="role">Role</label>
            <select id="role" name="role" class="input">
              <option value="user">User - Desk view & reports</option>
              <option value="admin">Administrator - System configuration</option>
            </select>
            <p class="helper">Role must match the user record (admin or user).</p>
          </div>

          <div class="alt-actions">
            <label class="checkbox">
              <input type="checkbox" checked>
              <span>Keep me signed in on this device</span>
            </label>
            <a href="#" aria-label="Go to password recovery">Forgot password?</a>
          </div>

          <button class="btn" type="submit">
            <svg width="18" height="18" viewBox="0 0 24 24" aria-hidden="true">
              <path fill="currentColor"
                d="M12 2a10 10 0 1 0 10 10A10.011 10.011 0 0 0 12 2m1 15h-2v-2h2zm0-4h-2V7h2z" />
            </svg>
            Sign in
          </button>

          <p class="helper">
            This screen calls the real authentication endpoint in the backend.
          </p>
        </form>
      </section>
    </main>
  </div>
  <script>
  document.querySelector(".form").addEventListener("submit", async function (e) {
    e.preventDefault();

    const email = document.getElementById("email").value;
    const password = document.getElementById("password").value;
    const role = document.getElementById("role").value; // user or admin

    try {
      const response = await fetch("/api/login", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ email, password, role })
      });

      const data = await response.json();

      if (!response.ok) {
        alert(data.message || "Error in login");
        return;
      }

      localStorage.setItem("token", data.token);

      // Redirect based on role to existing pages
      if (role === "admin") {
        window.location.href = "deskcontrol.html";
      } else {
        window.location.href = "healthreport.html";
      }
    } catch (err) {
      console.error(err);
      alert("Network or server error");
    }
  });
  </script>
</body>
</html>
